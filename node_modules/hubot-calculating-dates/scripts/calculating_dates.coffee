# Description
#  年月日の出力
# 
# Dependencies:
#  "hubot-calculating-dates": "1.0"
#
# Configuration:
#  環境設定を書く
#
# Commands:
#  today <数値> - 実行時から<数値>日後の年月日を出力
#
# Notes:
# Hubot> hubot today
# Hubot> 2014/11/24
# Hubot> hubot today 1
# Hubot> 2014/11/25
# Hubot> hubot today +1
# Hubot> 2014/11/25
# Hubot> hubot today -1
# Hubot> 2014/11/23
# Hubot> hubot today +365
# Hubot> 2015/11/24
#
# Author:
#  r-kumegawa


module.exports = (robot) ->
  robot.respond /today ([-+]?\d+)/i, (msg) ->
    num = parseInt(msg.match[1])
    replyDate(msg, num)

  robot.respond /today\s*$/i, (msg) ->
    replyDate(msg, 0)

replyDate = (msg, num) ->
    now = new Date(Date.now() + num * 24 * 60 * 60 * 1000)
    year = now.getFullYear()
    month = now.getMonth() + 1
    day = now.getDate()
    msg.send year + "/" + month + "/" + day
return
